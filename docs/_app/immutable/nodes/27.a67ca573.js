import{S as Xr,i as ea,s as ta,y as Sr,a as A,k as p,q as h,L as S,z as Rr,c as I,l as _,m as d,r as u,h as l,M as R,n as t,p as er,A as Vr,b as be,C as e,g as zr,d as Jr,B as Lr,Q as tr,E as Hr,o as ra,K as aa,O as na,u as Br,D as rt,J as Zr}from"../chunks/index.d6d9c1d5.js";import{H as oa}from"../chunks/global.a2390d33.js";import{S as sa}from"../chunks/SelectRegions.12365f43.js";import"../chunks/transform.4d2927c0.js";import{c as Xt,s as la,r as ia}from"../chunks/stores.64de824d.js";import{a as ca,t as ha,l as ua}from"../chunks/line.f1bfd7f4.js";import{l as da}from"../chunks/linear.6154f0ba.js";import{c as fa}from"../chunks/csv.3ac754ad.js";function va(a,r){let s;if(r===void 0)for(const o of a)o!=null&&(s<o||s===void 0&&o>=o)&&(s=o);else{let o=-1;for(let n of a)(n=r(n,++o,a))!=null&&(s<n||s===void 0&&n>=n)&&(s=n)}return s}function ma(a,r){let s;if(r===void 0)for(const o of a)o!=null&&(s>o||s===void 0&&o>=o)&&(s=o);else{let o=-1;for(let n of a)(n=r(n,++o,a))!=null&&(s>n||s===void 0&&n>=n)&&(s=n)}return s}function qr(a,r){let s=0,o=0;if(r===void 0)for(let n of a)n!=null&&(n=+n)>=n&&(++s,o+=n);else{let n=-1;for(let c of a)(c=r(c,++n,a))!=null&&(c=+c)>=c&&(++s,o+=c)}if(s)return o/s}const ga=!0,Ka=Object.freeze(Object.defineProperty({__proto__:null,prerender:ga},Symbol.toStringTag,{value:"Module"}));function Gr(a,r){return pa(a)||_a(a,r)||ya()}function pa(a){if(Array.isArray(a))return a}function _a(a,r){var s=[],o=!0,n=!1,c=void 0;try{for(var v=a[Symbol.iterator](),y;!(o=(y=v.next()).done)&&(s.push(y.value),!(r&&s.length===r));o=!0);}catch(w){n=!0,c=w}finally{try{!o&&v.return!=null&&v.return()}finally{if(n)throw c}}return s}function ya(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function wa(a,r,s,o){a=a.filter(function(j,G){var J=r(j,G),f=s(j,G);return J!=null&&isFinite(J)&&f!=null&&isFinite(f)}),o&&a.sort(function(j,G){return r(j)-r(G)});for(var n=a.length,c=new Float64Array(n),v=new Float64Array(n),y=0,w=0,V,B,q,z=0;z<n;)q=a[z],c[z]=V=+r(q,z,a),v[z]=B=+s(q,z,a),++z,y+=(V-y)/z,w+=(B-w)/z;for(var M=0;M<n;++M)c[M]-=y,v[M]-=w;return[c,v,y,w]}function ba(a,r,s,o){var n=o-a*a,c=Math.abs(n)<1e-24?0:(s-a*r)/n,v=r-c*a;return[v,c]}function ka(a){a.sort(function(s,o){return s-o});var r=a.length/2;return r%1===0?(a[r-1]+a[r])/2:a[Math.floor(r)]}var jr=2,Wr=1e-12;function xa(){var a=function(c){return c[0]},r=function(c){return c[1]},s=.3;function o(n){for(var c=wa(n,a,r,!0),v=Gr(c,4),y=v[0],w=v[1],V=v[2],B=v[3],q=y.length,z=Math.max(2,~~(s*q)),M=new Float64Array(q),j=new Float64Array(q),G=new Float64Array(q).fill(1),J=-1;++J<=jr;){for(var f=[0,z-1],b=0;b<q;++b){for(var E=y[b],W=f[0],L=f[1],T=E-y[W]>y[L]-E?W:L,D=0,U=0,se=0,K=0,X=0,H=1/Math.abs(y[T]-E||1),ee=W;ee<=L;++ee){var te=y[ee],C=w[ee],re=Ea(Math.abs(E-te)*H)*G[ee],ae=te*re;D+=re,U+=ae,se+=C*re,K+=C*ae,X+=te*ae}var ve=ba(U/D,se/D,K/D,X/D),le=Gr(ve,2),oe=le[0],P=le[1];M[b]=oe+P*E,j[b]=Math.abs(w[b]-M[b]),Da(y,b+1,f)}if(J===jr)break;var k=ka(j);if(Math.abs(k)<Wr)break;for(var N=0,m,x;N<q;++N)m=j[N]/(6*k),G[N]=m>=1?Wr:(x=1-m*m)*x}return Ca(y,M,V,B)}return o.bandwidth=function(n){return arguments.length?(s=n,o):s},o.x=function(n){return arguments.length?(a=n,o):a},o.y=function(n){return arguments.length?(r=n,o):r},o}function Ea(a){return(a=1-a*a*a)*a*a}function Da(a,r,s){var o=a[r],n=s[0],c=s[1]+1;if(!(c>=a.length))for(;r>n&&a[c]-o<=o-a[n];)s[0]=++n,s[1]=c,++c}function Ca(a,r,s,o){for(var n=a.length,c=[],v=0,y=0,w=[],V;v<n;++v)V=a[v]+s,w[0]===V?w[1]+=(r[v]-w[1])/++y:(y=0,w[1]+=o,w=[V,r[v]],c.push(w));return w[1]+=o,c}const Ma=""+new URL("../assets/green-arrow.0afd51fe.svg",import.meta.url).href,Aa=""+new URL("../assets/red-arrow.ede1cb71.svg",import.meta.url).href;function Kr(a,r,s){const o=a.slice();return o[14]=r[s].city,o[15]=r[s].regressionLine,o[16]=r[s].startCircle,o[17]=r[s].endCircle,o[18]=r[s].meanLine,o[19]=r[s].perChangeDisplay,o[20]=r[s].percentageChange,o[22]=s,o}function Ur(a,r,s){const o=a.slice();return o[23]=r[s],o[22]=s,o}function Or(a,r,s){const o=a.slice();return o[23]=r[s],o[22]=s,o}function Ia(a){let r;return{c(){r=S("line"),this.h()},l(s){r=R(s,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(r).forEach(l),this.h()},h(){t(r,"x1",260+a[22]*O/13),t(r,"y1",5),t(r,"x2",260+a[22]*O/13),t(r,"y2",40),t(r,"stroke","white"),t(r,"stroke-width","1")},m(s,o){be(s,r,o)},p:rt,d(s){s&&l(r)}}}function Yr(a){let r,s,o,n=a[23]===1&&Ia(a);return{c(){r=S("line"),n&&n.c(),s=S("text"),o=h(a[23]),this.h()},l(c){r=R(c,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(r).forEach(l),n&&n.l(c),s=R(c,"text",{x:!0,y:!0,class:!0});var v=d(s);o=u(v,a[23]),v.forEach(l),this.h()},h(){t(r,"x1",260+a[22]*O/13),t(r,"y1",45),t(r,"x2",260+a[22]*O/13),t(r,"y2",40),t(r,"stroke","white"),t(r,"stroke-width","1"),t(s,"x",260+a[22]*O/13+.5*O/13),t(s,"y","40"),t(s,"class","textMonth svelte-1crkxs9")},m(c,v){be(c,r,v),n&&n.m(c,v),be(c,s,v),e(s,o)},p(c,v){c[23]===1&&n.p(c,v)},d(c){c&&l(r),n&&n.d(c),c&&l(s)}}}function Na(a){let r,s;return{c(){r=p("img"),this.h()},l(o){r=_(o,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Zr(r.src,s=Aa)||t(r,"src",s),t(r,"alt","Down arrow"),t(r,"class","arrow-icon svelte-1crkxs9")},m(o,n){be(o,r,n)},p:rt,d(o){o&&l(r)}}}function Ta(a){let r,s;return{c(){r=p("img"),this.h()},l(o){r=_(o,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Zr(r.src,s=Ma)||t(r,"src",s),t(r,"alt","Up arrow"),t(r,"class","arrow-icon svelte-1crkxs9")},m(o,n){be(o,r,n)},p:rt,d(o){o&&l(r)}}}function Qr(a){let r;return{c(){r=S("line"),this.h()},l(s){r=R(s,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(r).forEach(l),this.h()},h(){t(r,"x1",a[23]*O/13),t(r,"y1",5),t(r,"x2",a[23]*O/13),t(r,"y2",45),t(r,"stroke","#333333"),t(r,"stroke-width","1")},m(s,o){be(s,r,o)},p:rt,d(s){s&&l(r)}}}function $r(a){let r,s,o,n,c,v,y=a[22]+1+"",w,V,B=a[14]+"",q,z,M,j,G,J,f,b=a[19]+"",E,W,L,T,D,U,se,K,X,H,ee,te,C,re,ae,ve;function le(m,x){if(m[20]>0)return Ta;if(m[20]<0)return Na}let oe=le(a),P=oe&&oe(a),k=[1,2,3,4,5,6,7,8,9,10,11,12],N=[];for(let m=0;m<12;m+=1)N[m]=Qr(Ur(a,k,m));return{c(){r=p("div"),s=p("div"),o=S("svg"),n=S("line"),v=S("text"),w=h(y),V=h(". "),q=h(B),z=A(),M=p("div"),P&&P.c(),j=A(),G=p("div"),J=S("svg"),f=S("text"),E=h(b),W=A(),L=p("div"),T=S("svg");for(let m=0;m<12;m+=1)N[m].c();D=S("line"),K=S("path"),H=S("circle"),C=S("circle"),this.h()},l(m){r=_(m,"DIV",{class:!0});var x=d(r);s=_(x,"DIV",{class:!0});var F=d(s);o=R(F,"svg",{width:!0,height:!0,class:!0});var ie=d(o);n=R(ie,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(n).forEach(l),v=R(ie,"text",{x:!0,y:!0,class:!0});var ke=d(v);w=u(ke,y),V=u(ke,". "),q=u(ke,B),ke.forEach(l),ie.forEach(l),F.forEach(l),z=I(x),M=_(x,"DIV",{class:!0});var Le=d(M);P&&P.l(Le),Le.forEach(l),j=I(x),G=_(x,"DIV",{class:!0});var xe=d(G);J=R(xe,"svg",{width:!0,height:!0,class:!0});var He=d(J);f=R(He,"text",{x:!0,y:!0,class:!0});var Be=d(f);E=u(Be,b),Be.forEach(l),He.forEach(l),xe.forEach(l),W=I(x),L=_(x,"DIV",{class:!0,style:!0});var Ee=d(L);T=R(Ee,"svg",{height:!0,width:!0,class:!0});var me=d(T);for(let Pe=0;Pe<12;Pe+=1)N[Pe].l(me);D=R(me,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0,"stroke-dasharray":!0}),d(D).forEach(l),K=R(me,"path",{d:!0,stroke:!0,"stroke-width":!0,fill:!0}),d(K).forEach(l),H=R(me,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),d(H).forEach(l),C=R(me,"circle",{cx:!0,cy:!0,r:!0,fill:!0,stroke:!0}),d(C).forEach(l),me.forEach(l),Ee.forEach(l),x.forEach(l),this.h()},h(){t(n,"x1","5"),t(n,"y1","15"),t(n,"x2","5"),t(n,"y2",Ye-15),t(n,"stroke",c=a[3](a[14])),t(n,"stroke-width","5"),t(v,"x","12"),t(v,"y","31"),t(v,"class","textCity svelte-1crkxs9"),t(o,"width","150"),t(o,"height",Ye),t(o,"class","region-bar"),t(s,"class","left svelte-1crkxs9"),t(M,"class","arrow svelte-1crkxs9"),t(f,"x","46"),t(f,"y","45"),t(f,"class","textPercent svelte-1crkxs9"),t(J,"width","50"),t(J,"height",Ye),t(J,"class","region-bar"),t(G,"class","number svelte-1crkxs9"),t(D,"x1","0"),t(D,"y1",U=a[18]),t(D,"x2",O),t(D,"y2",se=a[18]),t(D,"stroke","#D0D1C9"),t(D,"stroke-width","1"),t(D,"stroke-dasharray","4"),t(K,"d",X=a[15]),t(K,"stroke","white"),t(K,"stroke-width","2"),t(K,"fill","none"),t(H,"cx",ee=a[16].cx),t(H,"cy",te=a[16].cy),t(H,"r","2"),t(H,"fill","white"),t(C,"cx",re=a[17].cx),t(C,"cy",ae=a[17].cy),t(C,"r","2"),t(C,"fill","white"),t(C,"stroke","white"),t(T,"height",Ye),t(T,"width",O),t(T,"class","chart svelte-1crkxs9"),t(L,"class","chart-container svelte-1crkxs9"),er(L,"width",O),t(r,"class","chart-wrapper svelte-1crkxs9"),aa(()=>a[9].call(r))},m(m,x){be(m,r,x),e(r,s),e(s,o),e(o,n),e(o,v),e(v,w),e(v,V),e(v,q),e(r,z),e(r,M),P&&P.m(M,null),e(r,j),e(r,G),e(G,J),e(J,f),e(f,E),e(r,W),e(r,L),e(L,T);for(let F=0;F<12;F+=1)N[F]&&N[F].m(T,null);e(T,D),e(T,K),e(T,H),e(T,C),ve=na(r,a[9].bind(r))},p(m,x){if(x&2&&c!==(c=m[3](m[14]))&&t(n,"stroke",c),x&2&&B!==(B=m[14]+"")&&Br(q,B),oe===(oe=le(m))&&P?P.p(m,x):(P&&P.d(1),P=oe&&oe(m),P&&(P.c(),P.m(M,null))),x&2&&b!==(b=m[19]+"")&&Br(E,b),x&0){k=[1,2,3,4,5,6,7,8,9,10,11,12];let F;for(F=0;F<12;F+=1){const ie=Ur(m,k,F);N[F]?N[F].p(ie,x):(N[F]=Qr(ie),N[F].c(),N[F].m(T,D))}for(;F<12;F+=1)N[F].d(1)}x&2&&U!==(U=m[18])&&t(D,"y1",U),x&2&&se!==(se=m[18])&&t(D,"y2",se),x&2&&X!==(X=m[15])&&t(K,"d",X),x&2&&ee!==(ee=m[16].cx)&&t(H,"cx",ee),x&2&&te!==(te=m[16].cy)&&t(H,"cy",te),x&2&&re!==(re=m[17].cx)&&t(C,"cx",re),x&2&&ae!==(ae=m[17].cy)&&t(C,"cy",ae)},d(m){m&&l(r),P&&P.d(),tr(N,m),ve()}}}function Pa(a){let r,s,o,n,c,v,y,w,V,B,q,z,M,j,G,J,f,b,E,W,L,T,D,U,se=a[2].day2+"",K,X,H,ee,te,C,re,ae=a[2].monthName+"",ve,le,oe=a[2].monthName+"",P,k,N=a[2].monthName+"",m,x,F,ie,ke,Le,xe,He,Be,Ee,me,Pe,Fe,at,qe,nt,ot,st,Qe,lt,it,pe,ct,rr=a[2].monthName+"",ht,ut,ar=a[2].monthName+"",dt,ft,vt,$e,mt,gt,Se,pt,ce,Re,de,_t,nr=a[2].monthName+"",yt,wt,or=a[2].year1+"",bt,kt,xt,Ge,je,$,De,Et,Ce,Dt,ne,sr=a[2].monthNumber+"",Ct,Mt,lr=a[2].year2+"",At,It,ir=a[2].monthNumber+"",Nt,Tt,cr=a[2].year1+"",Pt,Me,hr=a[2].year1+"",Ft,Ae,ur=a[2].year2+"",St,ge,fe,Rt,Xe,Z,Vt,zt,Jt,Lt,Ze,Ht,Bt,_e,qt,We,Gt,jt,Ve,Wt,Kt,Ut,Ot,Yt,Qt,et;r=new oa({}),Se=new sa({props:{europe:"no",canada:"yes"}});let $t=[4,5,6,7,8,9,10,11,12,1,2,3,4],he=[];for(let g=0;g<13;g+=1)he[g]=Yr(Or(a,$t,g));let Ke=a[1],Y=[];for(let g=0;g<Ke.length;g+=1)Y[g]=$r(Kr(a,Ke,g));return{c(){Sr(r.$$.fragment),s=A(),o=p("main"),n=p("div"),c=p("h1"),v=h("Recovery Trends"),y=A(),w=p("p"),V=h("By "),B=p("a"),q=h("Karen Chapple"),z=h(", "),M=p("a"),j=h("Julia Greenberg"),G=h(", "),J=p("a"),f=h("Jeff Allen"),b=h(", "),E=p("a"),W=h("Irene Chang"),L=A(),T=p("p"),D=p("i"),U=h("Updated "),K=h(se),X=A(),H=p("p"),ee=h("Data on cell phone activity (a.k.a. footfall) trends for the last year provide a picture of how downtowns are faring since our last rankings update in the summer of 2023. We look here at year-over-year (2024 vs. 2023) trends, updated monthly."),te=A(),C=p("p"),re=h("The dotted line provides a baseline of the average level of activity in "),ve=h(ae),le=h(" 2023, allowing for comparison to subsequent months. The solid line represents the average level of activity by week. When the solid line extends above the dotted baseline, downtown activity is greater compared to in "),P=h(oe),k=h(" 2023. When it dips below the dotted line, activity is on a downswing. For most cities, there is an increase in month 6 or 7; this is expected since these are the summer months of June and July. The fall months see decreasing activity on average, with almost all downtowns losing activity by November. However, some cities stay above the "),m=h(N),x=h(" baseline, suggesting gradual recovery, while others dip well below it, i.e., stagnating recovery."),F=A(),ie=p("h5"),ke=h("Key Findings"),Le=A(),xe=p("p"),He=h("Median rate of change = +9.35%"),Be=A(),Ee=p("p"),me=h("52 downtowns are in an upward trajectory, while 12 are trending downwards"),Pe=A(),Fe=p("p"),at=h("In general, the downtowns that are seeing the highest rates of activity increase are the downtowns where recovery was lagging in our "),qe=p("a"),nt=h("2023 rankings"),ot=h("."),st=A(),Qe=p("p"),lt=h("Note: Trends are based on data from Spectus, but use different cell phone data providers from our rankings analysis. The trendlines measure the average level of activity over the course of the year, while the ranking metric shows the percent difference in the average number of stops in 2024 versus the same month in 2023."),it=A(),pe=p("h4"),ct=h("Visits to Downtown ("),ht=h(rr),ut=h(" 1, 2023 to "),dt=h(ar),ft=h(" 30, 2024)"),vt=A(),$e=p("p"),mt=h("Select Regions:"),gt=A(),Sr(Se.$$.fragment),pt=A(),ce=p("p"),Re=S("svg"),de=S("line"),_t=A(),yt=h(nr),wt=A(),bt=h(or),kt=h(" average"),xt=A(),Ge=p("div"),je=p("div"),$=S("svg"),De=S("text"),Et=h("City"),Ce=S("text"),Dt=h("Percent Change in Visits"),ne=S("text"),Ct=h(sr),Mt=h("/"),At=h(lr),It=h(" vs. "),Nt=h(ir),Tt=h("/"),Pt=h(cr),Me=S("text"),Ft=h(hr),Ae=S("text"),St=h(ur),ge=S("line");for(let g=0;g<13;g+=1)he[g].c();fe=S("line"),Rt=A();for(let g=0;g<Y.length;g+=1)Y[g].c();Xe=A(),Z=p("div"),Vt=p("br"),zt=A(),Jt=p("br"),Lt=A(),Ze=p("h4"),Ht=h("More Information"),Bt=A(),_e=p("p"),qt=h("You can download the data shown on the chart "),We=p("a"),Gt=h("here"),jt=h(". The data on the charts are based on the `normalized_distinct_clean` column, which pertains to the number of unique daily visitors normalized by the total number in the metro area. The trend-line and summary statistics shown are calculated in JavaScript (code is "),Ve=p("a"),Wt=h("here"),Kt=h(")"),Ut=A(),Ot=p("br"),Yt=A(),Qt=p("br"),this.h()},l(g){Rr(r.$$.fragment,g),s=I(g),o=_(g,"MAIN",{});var Q=d(o);n=_(Q,"DIV",{class:!0});var i=d(n);c=_(i,"H1",{});var Ie=d(c);v=u(Ie,"Recovery Trends"),Ie.forEach(l),y=I(i),w=_(i,"P",{});var ye=d(w);V=u(ye,"By "),B=_(ye,"A",{href:!0});var dr=d(B);q=u(dr,"Karen Chapple"),dr.forEach(l),z=u(ye,", "),M=_(ye,"A",{href:!0});var fr=d(M);j=u(fr,"Julia Greenberg"),fr.forEach(l),G=u(ye,", "),J=_(ye,"A",{href:!0});var vr=d(J);f=u(vr,"Jeff Allen"),vr.forEach(l),b=u(ye,", "),E=_(ye,"A",{href:!0});var mr=d(E);W=u(mr,"Irene Chang"),mr.forEach(l),ye.forEach(l),L=I(i),T=_(i,"P",{});var gr=d(T);D=_(gr,"I",{});var Zt=d(D);U=u(Zt,"Updated "),K=u(Zt,se),Zt.forEach(l),gr.forEach(l),X=I(i),H=_(i,"P",{});var pr=d(H);ee=u(pr,"Data on cell phone activity (a.k.a. footfall) trends for the last year provide a picture of how downtowns are faring since our last rankings update in the summer of 2023. We look here at year-over-year (2024 vs. 2023) trends, updated monthly."),pr.forEach(l),te=I(i),C=_(i,"P",{});var Ne=d(C);re=u(Ne,"The dotted line provides a baseline of the average level of activity in "),ve=u(Ne,ae),le=u(Ne," 2023, allowing for comparison to subsequent months. The solid line represents the average level of activity by week. When the solid line extends above the dotted baseline, downtown activity is greater compared to in "),P=u(Ne,oe),k=u(Ne," 2023. When it dips below the dotted line, activity is on a downswing. For most cities, there is an increase in month 6 or 7; this is expected since these are the summer months of June and July. The fall months see decreasing activity on average, with almost all downtowns losing activity by November. However, some cities stay above the "),m=u(Ne,N),x=u(Ne," baseline, suggesting gradual recovery, while others dip well below it, i.e., stagnating recovery."),Ne.forEach(l),F=I(i),ie=_(i,"H5",{});var _r=d(ie);ke=u(_r,"Key Findings"),_r.forEach(l),Le=I(i),xe=_(i,"P",{});var yr=d(xe);He=u(yr,"Median rate of change = +9.35%"),yr.forEach(l),Be=I(i),Ee=_(i,"P",{});var wr=d(Ee);me=u(wr,"52 downtowns are in an upward trajectory, while 12 are trending downwards"),wr.forEach(l),Pe=I(i),Fe=_(i,"P",{});var tt=d(Fe);at=u(tt,"In general, the downtowns that are seeing the highest rates of activity increase are the downtowns where recovery was lagging in our "),qe=_(tt,"A",{href:!0});var br=d(qe);nt=u(br,"2023 rankings"),br.forEach(l),ot=u(tt,"."),tt.forEach(l),st=I(i),Qe=_(i,"P",{});var kr=d(Qe);lt=u(kr,"Note: Trends are based on data from Spectus, but use different cell phone data providers from our rankings analysis. The trendlines measure the average level of activity over the course of the year, while the ranking metric shows the percent difference in the average number of stops in 2024 versus the same month in 2023."),kr.forEach(l),it=I(i),pe=_(i,"H4",{});var Ue=d(pe);ct=u(Ue,"Visits to Downtown ("),ht=u(Ue,rr),ut=u(Ue," 1, 2023 to "),dt=u(Ue,ar),ft=u(Ue," 30, 2024)"),Ue.forEach(l),vt=I(i),$e=_(i,"P",{});var xr=d($e);mt=u(xr,"Select Regions:"),xr.forEach(l),gt=I(i),Rr(Se.$$.fragment,i),pt=I(i),ce=_(i,"P",{style:!0});var ze=d(ce);Re=R(ze,"svg",{height:!0,width:!0});var Er=d(Re);de=R(Er,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0,"stroke-dasharray":!0}),d(de).forEach(l),Er.forEach(l),_t=I(ze),yt=u(ze,nr),wt=I(ze),bt=u(ze,or),kt=u(ze," average"),ze.forEach(l),i.forEach(l),xt=I(Q),Ge=_(Q,"DIV",{class:!0});var Dr=d(Ge);je=_(Dr,"DIV",{class:!0});var Cr=d(je);$=R(Cr,"svg",{width:!0,height:!0,class:!0});var we=d($);De=R(we,"text",{x:!0,y:!0,class:!0});var Mr=d(De);Et=u(Mr,"City"),Mr.forEach(l),Ce=R(we,"text",{x:!0,y:!0,class:!0});var Ar=d(Ce);Dt=u(Ar,"Percent Change in Visits"),Ar.forEach(l),ne=R(we,"text",{x:!0,y:!0,class:!0});var Te=d(ne);Ct=u(Te,sr),Mt=u(Te,"/"),At=u(Te,lr),It=u(Te," vs. "),Nt=u(Te,ir),Tt=u(Te,"/"),Pt=u(Te,cr),Te.forEach(l),Me=R(we,"text",{x:!0,y:!0,class:!0});var Ir=d(Me);Ft=u(Ir,hr),Ir.forEach(l),Ae=R(we,"text",{x:!0,y:!0,class:!0});var Nr=d(Ae);St=u(Nr,ur),Nr.forEach(l),ge=R(we,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(ge).forEach(l);for(let Je=0;Je<13;Je+=1)he[Je].l(we);fe=R(we,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(fe).forEach(l),we.forEach(l),Cr.forEach(l),Dr.forEach(l),Rt=I(Q);for(let Je=0;Je<Y.length;Je+=1)Y[Je].l(Q);Xe=I(Q),Z=_(Q,"DIV",{class:!0});var ue=d(Z);Vt=_(ue,"BR",{}),zt=I(ue),Jt=_(ue,"BR",{}),Lt=I(ue),Ze=_(ue,"H4",{});var Tr=d(Ze);Ht=u(Tr,"More Information"),Tr.forEach(l),Bt=I(ue),_e=_(ue,"P",{});var Oe=d(_e);qt=u(Oe,"You can download the data shown on the chart "),We=_(Oe,"A",{href:!0});var Pr=d(We);Gt=u(Pr,"here"),Pr.forEach(l),jt=u(Oe,". The data on the charts are based on the `normalized_distinct_clean` column, which pertains to the number of unique daily visitors normalized by the total number in the metro area. The trend-line and summary statistics shown are calculated in JavaScript (code is "),Ve=_(Oe,"A",{href:!0,target:!0});var Fr=d(Ve);Wt=u(Fr,"here"),Fr.forEach(l),Kt=u(Oe,")"),Oe.forEach(l),Ut=I(ue),Ot=_(ue,"BR",{}),Yt=I(ue),Qt=_(ue,"BR",{}),ue.forEach(l),Q.forEach(l),this.h()},h(){t(B,"href","https://schoolofcities.utoronto.ca/people/karen-chapple/"),t(M,"href","https://www.urbandisplacement.org/team/julia-greenberg/"),t(J,"href","https://schoolofcities.utoronto.ca/people/jeff-allen/"),t(E,"href","https://www.linkedin.com/in/irene-kcc/"),t(qe,"href","/charts/rankings"),t(de,"x1","0"),t(de,"y1","5"),t(de,"x2","50"),t(de,"y2","5"),t(de,"stroke","white"),t(de,"stroke-width","1"),t(de,"stroke-dasharray","4"),t(Re,"height","10"),t(Re,"width","50"),er(ce,"padding-top","10px"),er(ce,"padding-bottom","10px"),t(n,"class","text svelte-1crkxs9"),t(De,"x","12"),t(De,"y","35"),t(De,"class","textCity svelte-1crkxs9"),t(Ce,"x","235"),t(Ce,"y","15"),t(Ce,"class","textLabel svelte-1crkxs9"),t(ne,"x","235"),t(ne,"y","35"),t(ne,"class","textLabel svelte-1crkxs9"),t(Me,"x",260+(13-a[2].monthNumber)/2*O/13),t(Me,"y","15"),t(Me,"class","textMonth svelte-1crkxs9"),t(Ae,"x",260+(13-a[2].monthNumber)*O/13+a[2].monthNumber/2*O/13),t(Ae,"y","15"),t(Ae,"class","textMonth svelte-1crkxs9"),t(ge,"x1","260"),t(ge,"y1",45),t(ge,"x2",260+O),t(ge,"y2",45),t(ge,"stroke","white"),t(ge,"stroke-width","1"),t(fe,"x1",259+O),t(fe,"y1",45),t(fe,"x2",259+O),t(fe,"y2",40),t(fe,"stroke","white"),t(fe,"stroke-width","1"),t($,"width","760"),t($,"height",Ye),t($,"class","region-bar"),t(je,"class","left svelte-1crkxs9"),t(Ge,"class","chart-wrapper svelte-1crkxs9"),t(We,"href","/trends.csv"),t(Ve,"href","https://github.com/schoolofcities/downtown-recovery/blob/main/src/routes/charts/trends/%2Bpage.svelte"),t(Ve,"target","_blank"),t(Z,"class","text svelte-1crkxs9")},m(g,Q){Vr(r,g,Q),be(g,s,Q),be(g,o,Q),e(o,n),e(n,c),e(c,v),e(n,y),e(n,w),e(w,V),e(w,B),e(B,q),e(w,z),e(w,M),e(M,j),e(w,G),e(w,J),e(J,f),e(w,b),e(w,E),e(E,W),e(n,L),e(n,T),e(T,D),e(D,U),e(D,K),e(n,X),e(n,H),e(H,ee),e(n,te),e(n,C),e(C,re),e(C,ve),e(C,le),e(C,P),e(C,k),e(C,m),e(C,x),e(n,F),e(n,ie),e(ie,ke),e(n,Le),e(n,xe),e(xe,He),e(n,Be),e(n,Ee),e(Ee,me),e(n,Pe),e(n,Fe),e(Fe,at),e(Fe,qe),e(qe,nt),e(Fe,ot),e(n,st),e(n,Qe),e(Qe,lt),e(n,it),e(n,pe),e(pe,ct),e(pe,ht),e(pe,ut),e(pe,dt),e(pe,ft),e(n,vt),e(n,$e),e($e,mt),e(n,gt),Vr(Se,n,null),e(n,pt),e(n,ce),e(ce,Re),e(Re,de),e(ce,_t),e(ce,yt),e(ce,wt),e(ce,bt),e(ce,kt),e(o,xt),e(o,Ge),e(Ge,je),e(je,$),e($,De),e(De,Et),e($,Ce),e(Ce,Dt),e($,ne),e(ne,Ct),e(ne,Mt),e(ne,At),e(ne,It),e(ne,Nt),e(ne,Tt),e(ne,Pt),e($,Me),e(Me,Ft),e($,Ae),e(Ae,St),e($,ge);for(let i=0;i<13;i+=1)he[i]&&he[i].m($,null);e($,fe),e(o,Rt);for(let i=0;i<Y.length;i+=1)Y[i]&&Y[i].m(o,null);e(o,Xe),e(o,Z),e(Z,Vt),e(Z,zt),e(Z,Jt),e(Z,Lt),e(Z,Ze),e(Ze,Ht),e(Z,Bt),e(Z,_e),e(_e,qt),e(_e,We),e(We,Gt),e(_e,jt),e(_e,Ve),e(Ve,Wt),e(_e,Kt),e(Z,Ut),e(Z,Ot),e(Z,Yt),e(Z,Qt),et=!0},p(g,[Q]){if(Q&0){$t=[4,5,6,7,8,9,10,11,12,1,2,3,4];let i;for(i=0;i<13;i+=1){const Ie=Or(g,$t,i);he[i]?he[i].p(Ie,Q):(he[i]=Yr(Ie),he[i].c(),he[i].m($,fe))}for(;i<13;i+=1)he[i].d(1)}if(Q&11){Ke=g[1];let i;for(i=0;i<Ke.length;i+=1){const Ie=Kr(g,Ke,i);Y[i]?Y[i].p(Ie,Q):(Y[i]=$r(Ie),Y[i].c(),Y[i].m(o,Xe))}for(;i<Y.length;i+=1)Y[i].d(1);Y.length=Ke.length}},i(g){et||(zr(r.$$.fragment,g),zr(Se.$$.fragment,g),et=!0)},o(g){Jr(r.$$.fragment,g),Jr(Se.$$.fragment,g),et=!1},d(g){Lr(r,g),g&&l(s),g&&l(o),Lr(Se),tr(he,g),tr(Y,g)}}}let O=500;const Ye=50,Fa=0,Sa=5,Ra=0,Va=5;function za(a,r,s){let o,n,c;Hr(a,la,f=>s(8,n=f)),Hr(a,ia,f=>s(10,c=f));const v=c;let y={monthName:"April",monthNumber:4,year1:2023,year2:2024,day1:"2023-04-01",day2:"2024-04-30"};async function w(){try{const b=await(await fetch("/trends.csv")).text();s(4,V=fa(b)),s(5,z=[...new Set(V.map(E=>E.city))])}catch(f){console.error("Error loading CSV data:",f)}}let V=[];ra(()=>{w(),s(7,o=Xt.filter(f=>n.includes(f.region)).map(f=>f.city))});let B;const q=ca("%Y-%m-%d");let z=[],M=[],j=[];function G(f){const b=Xt.filter(E=>E.city===f);if(b){const E=b[0].region,W=v.find(L=>L.name===E);if(W)return W.colour}else return"white"}function J(){B=this.clientWidth,s(0,B)}return a.$$.update=()=>{a.$$.dirty&256&&s(7,o=Xt.filter(f=>n.includes(f.region)).map(f=>f.city)),a.$$.dirty&176&&s(6,M=z.map(f=>{if(o.includes(f)){const b=V.filter(E=>{const W=new Date(E.date),L=new Date(y.day1),T=new Date(y.day2);return E.city===f&&W>=L&&W<=T});if(b.length>0){console.log("cityData");const E=b.map(k=>parseFloat(k.normalized_distinct_clean)),W=V.filter(k=>{const N=new Date(k.date);return N.getFullYear()===y.year1&&N.getMonth()===y.monthNumber-1&&k.city===f}),L=qr(W,k=>parseFloat(k.normalized_distinct_clean)),T=V.filter(k=>{const N=new Date(k.date);return N.getFullYear()===y.year2&&N.getMonth()===y.monthNumber-1&&k.city===f}),D=qr(T,k=>parseFloat(k.normalized_distinct_clean)),U=xa().x(k=>q(k.date)).y(k=>parseFloat(k.normalized_distinct_clean)).bandwidth(.03),se=Math.min(...U(b).map(k=>k[1]),ma(E)),K=Math.max(...U(b).map(k=>k[1]),va(E)),X=ha().domain([new Date(y.day1),new Date(y.day2)]).range([Va,O-Sa]),H=da().domain([se,K]).range([Ye-Ra,Fa]),te=ua().x(k=>X(k[0])).y(k=>H(k[1]))(U(b));f==="Quebec"&&(console.log(b),console.log(U(b)),console.log(K));const C=(D-L)/L*100,re=C.toFixed(1)+"%",ae=U(b)[0],ve={cx:X(ae[0]),cy:H(ae[1]),radius:6,fill:"red",stroke:"red","stroke-width":2},le=U(b)[395],oe={cx:X(le[0]),cy:H(le[1]),radius:6,fill:"red",stroke:"#6aa687","stroke-width":2},P=H(L);return{city:f,regressionLine:te,meanLine:P,startCircle:ve,endCircle:oe,perChangeDisplay:re,percentageChange:C}}}}).filter(f=>f!==void 0)),a.$$.dirty&64&&s(1,j=M.slice().sort((f,b)=>b.percentageChange-f.percentageChange))},[B,j,y,G,V,z,M,o,n,J]}class Ua extends Xr{constructor(r){super(),ea(this,r,za,Pa,ta,{})}}export{Ua as component,Ka as universal};
