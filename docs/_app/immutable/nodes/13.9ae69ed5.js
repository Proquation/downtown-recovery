import{S as We,i as Be,s as Qe,y as ge,a as Q,k as q,q as w,N as W,e as oe,z as ye,c as U,l as O,m as y,r as k,h as c,O as B,n as l,P as Ue,A as be,b as C,C as f,Q as Xe,g as we,d as ke,B as Ee,M as Me,E as De,o as Ge,u as ie,p as T}from"../chunks/index.a4677e45.js";import{H as Je}from"../chunks/global.72491dd2.js";import{S as Ke,a as Le}from"../chunks/SelectRegions.c5331a71.js";import{c as Ye,a as Ze,b as et,r as tt}from"../chunks/csv.a309fd1d.js";const lt=!0,ft=Object.freeze(Object.defineProperty({__proto__:null,prerender:lt},Symbol.toStringTag,{value:"Module"}));function Ce(e,t,h){const r=e.slice();return r[17]=t[h],r[19]=h,r}function Fe(e,t,h){const r=e.slice();return r[20]=t[h],r[19]=h,r}function ze(e,t,h){const r=e.slice();return r[17]=t[h],r[19]=h,r}function Te(e){let t,h,r,s,i,u,d,g=(100*e[17]).toFixed(0)+"",_,A,E;return{c(){t=W("line"),s=W("line"),d=W("text"),_=w(g),A=w("%"),this.h()},l(v){t=B(v,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0}),y(t).forEach(c),s=B(v,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0}),y(s).forEach(c),d=B(v,"text",{class:!0,x:!0,y:!0,"text-anchor":!0});var p=y(d);_=k(p,g),A=k(p,"%"),p.forEach(c),this.h()},h(){l(t,"class","grid svelte-1r8269s"),l(t,"x1",h=29+e[19]*e[4]),l(t,"y1","34"),l(t,"x2",r=29+e[19]*e[4]),l(t,"y2",e[3]),l(s,"class","grid-white svelte-1r8269s"),l(s,"x1",i=29+e[19]*e[4]),l(s,"y1","34"),l(s,"x2",u=29+e[19]*e[4]),l(s,"y2","38"),l(d,"class","axis-label svelte-1r8269s"),l(d,"x",E=35+e[19]*e[4]),l(d,"y","30"),l(d,"text-anchor","end")},m(v,p){C(v,t,p),C(v,s,p),C(v,d,p),f(d,_),f(d,A)},p(v,p){p&16&&h!==(h=29+v[19]*v[4])&&l(t,"x1",h),p&16&&r!==(r=29+v[19]*v[4])&&l(t,"x2",r),p&8&&l(t,"y2",v[3]),p&16&&i!==(i=29+v[19]*v[4])&&l(s,"x1",i),p&16&&u!==(u=29+v[19]*v[4])&&l(s,"x2",u),p&4&&g!==(g=(100*v[17]).toFixed(0)+"")&&ie(_,g),p&16&&E!==(E=35+v[19]*v[4])&&l(d,"x",E)},d(v){v&&c(t),v&&c(s),v&&c(d)}}}function He(e){let t,h=e[20].display_title+"",r,s,i=Math.round(100*e[20].seasonal_average)+"",u,d;return{c(){t=W("text"),r=w(h),s=w(" - "),u=w(i),d=w("%"),this.h()},l(g){t=B(g,"text",{class:!0,x:!0,y:!0,style:!0});var _=y(t);r=k(_,h),s=k(_," - "),u=k(_,i),d=k(_,"%"),_.forEach(c),this.h()},h(){l(t,"class","bar-label svelte-1r8269s"),l(t,"x","32"),l(t,"y",56+e[19]*24),T(t,"fill","#000"),T(t,"fill-opacity","0"),T(t,"stroke","#fff"),T(t,"stroke-width","2px"),T(t,"stroke-opacity","0.5")},m(g,_){C(g,t,_),f(t,r),f(t,s),f(t,u),f(t,d)},p(g,_){_&1&&h!==(h=g[20].display_title+"")&&ie(r,h),_&1&&i!==(i=Math.round(100*g[20].seasonal_average)+"")&&ie(u,i)},d(g){g&&c(t)}}}function Ne(e){let t,h,r,s,i,u=e[19]+1+"",d,g=e[5].find(X).text==="#000",_,A=e[20].display_title+"",E,v,p=Math.round(100*e[20].seasonal_average)+"",R,F;function X(...n){return e[10](e[20],...n)}function V(...n){return e[11](e[20],...n)}let b=g&&He(e);function H(...n){return e[12](e[20],...n)}return{c(){t=W("line"),r=W("line"),i=W("text"),d=w(u),b&&b.c(),_=W("text"),E=w(A),v=w(" - "),R=w(p),F=w("%"),this.h()},l(n){t=B(n,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,style:!0}),y(t).forEach(c),r=B(n,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,style:!0}),y(r).forEach(c),i=B(n,"text",{class:!0,x:!0,y:!0,"text-anchor":!0});var m=y(i);d=k(m,u),m.forEach(c),b&&b.l(n),_=B(n,"text",{class:!0,x:!0,y:!0,style:!0});var P=y(_);E=k(P,A),v=k(P," - "),R=k(P,p),F=k(P,"%"),P.forEach(c),this.h()},h(){l(t,"class","bar"),l(t,"x1",29),l(t,"y1",52+e[19]*24),l(t,"x2",h=e[20].seasonal_average*(e[1]-29)/Math.max(...e[2])),l(t,"y2",52+e[19]*24),T(t,"stroke","white"),T(t,"stroke-width","20 "),l(r,"class","bar"),l(r,"x1",30),l(r,"y1",52+e[19]*24),l(r,"x2",s=e[20].seasonal_average*(e[1]-29)/Math.max(...e[2])-1),l(r,"y2",52+e[19]*24),T(r,"stroke",e[5].find(V).colour),T(r,"stroke-width","18"),l(i,"class","axis-label svelte-1r8269s"),l(i,"x","25"),l(i,"y",57+e[19]*24),l(i,"text-anchor","end"),l(_,"class","bar-label svelte-1r8269s"),l(_,"x","32"),l(_,"y",56+e[19]*24),T(_,"fill",e[5].find(H).text)},m(n,m){C(n,t,m),C(n,r,m),C(n,i,m),f(i,d),b&&b.m(n,m),C(n,_,m),f(_,E),f(_,v),f(_,R),f(_,F)},p(n,m){e=n,m&7&&h!==(h=e[20].seasonal_average*(e[1]-29)/Math.max(...e[2]))&&l(t,"x2",h),m&7&&s!==(s=e[20].seasonal_average*(e[1]-29)/Math.max(...e[2])-1)&&l(r,"x2",s),m&1&&T(r,"stroke",e[5].find(V).colour),m&1&&(g=e[5].find(X).text==="#000"),g?b?b.p(e,m):(b=He(e),b.c(),b.m(_.parentNode,_)):b&&(b.d(1),b=null),m&1&&A!==(A=e[20].display_title+"")&&ie(E,A),m&1&&p!==(p=Math.round(100*e[20].seasonal_average)+"")&&ie(R,p),m&1&&T(_,"fill",e[5].find(H).text)},d(n){n&&c(t),n&&c(r),n&&c(i),b&&b.d(n),n&&c(_)}}}function $e(e){let t,h,r;return{c(){t=W("line"),this.h()},l(s){t=B(s,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,"stroke-opacity":!0,"stroke-dasharray":!0}),y(t).forEach(c),this.h()},h(){l(t,"class","grid-white svelte-1r8269s"),l(t,"x1",h=29+e[19]*e[4]),l(t,"y1","34"),l(t,"x2",r=29+e[19]*e[4]),l(t,"y2",e[3]),l(t,"stroke-opacity","0.75"),l(t,"stroke-dasharray","2 2")},m(s,i){C(s,t,i)},p(s,i){i&16&&h!==(h=29+s[19]*s[4])&&l(t,"x1",h),i&16&&r!==(r=29+s[19]*s[4])&&l(t,"x2",r),i&8&&l(t,"y2",s[3])},d(s){s&&c(t)}}}function je(e){let t,h,r,s,i=e[17]===1&&$e(e);return{c(){t=W("line"),i&&i.c(),s=oe(),this.h()},l(u){t=B(u,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,"stroke-opacity":!0}),y(t).forEach(c),i&&i.l(u),s=oe(),this.h()},h(){l(t,"class","grid svelte-1r8269s"),l(t,"x1",h=29+e[19]*e[4]),l(t,"y1","34"),l(t,"x2",r=29+e[19]*e[4]),l(t,"y2",e[3]),l(t,"stroke-opacity","0.21")},m(u,d){C(u,t,d),i&&i.m(u,d),C(u,s,d)},p(u,d){d&16&&h!==(h=29+u[19]*u[4])&&l(t,"x1",h),d&16&&r!==(r=29+u[19]*u[4])&&l(t,"x2",r),d&8&&l(t,"y2",u[3]),u[17]===1?i?i.p(u,d):(i=$e(u),i.c(),i.m(s.parentNode,s)):i&&(i.d(1),i=null)},d(u){u&&c(t),i&&i.d(u),u&&c(s)}}}function at(e){let t,h,r,s,i,u,d,g,_,A,E,v,p,R,F,X,V,b,H,n,m,P,G,_e,ce,z,N,J,K,de,L,Y,ve,Z,pe,me,M,ne,he,Se,ee;t=new Je({}),K=new Ke({}),Y=new Le({props:{europe:"yes"}});let te=e[2],D=[];for(let o=0;o<te.length;o+=1)D[o]=Te(ze(e,te,o));let le=e[0],S=[];for(let o=0;o<le.length;o+=1)S[o]=Ne(Fe(e,le,o));let ae=e[2],x=[];for(let o=0;o<ae.length;o+=1)x[o]=je(Ce(e,ae,o));return{c(){ge(t.$$.fragment),h=Q(),r=q("main"),s=q("div"),i=q("h1"),u=w("Downtown Recovery Rankings"),d=Q(),g=q("p"),_=w("The recovery metrics on these charts are based on a sample of mobile phone data."),A=Q(),E=q("p"),v=w("They are computed by counting the number of unique mobile phones in a city's downtown area in the specified time period, and then dividing it by the number of unique visitors during the equivalent time period in 2019. For example, the March 2023 - May 2023 time period is compared to the March 2019 - May 2019 time period."),p=Q(),R=q("p"),F=w("A recovery metric greater than 100% means that for the selected inputs, the mobile device activity increased relative to the comparison period. A value less than 100% means the opposite, that the city's downtown has not recovered to pre-COVID activity levels."),X=Q(),V=q("p"),b=w("For more information, read our "),H=q("a"),n=w("Methodology"),m=w(" page. Or click "),P=q("a"),G=w("here"),_e=w(" to download the data shown on this chart."),ce=Q(),z=q("div"),N=q("div"),J=q("div"),ge(K.$$.fragment),de=Q(),L=q("div"),ge(Y.$$.fragment),ve=Q(),Z=q("p"),pe=w("*Data for Europe is only available from 12/2021 to 02/2023"),me=Q(),M=W("svg");for(let o=0;o<D.length;o+=1)D[o].c();ne=oe();for(let o=0;o<S.length;o+=1)S[o].c();he=oe();for(let o=0;o<x.length;o+=1)x[o].c();this.h()},l(o){ye(t.$$.fragment,o),h=U(o),r=O(o,"MAIN",{class:!0});var I=y(r);s=O(I,"DIV",{class:!0});var a=y(s);i=O(a,"H1",{});var $=y(i);u=k($,"Downtown Recovery Rankings"),$.forEach(c),d=U(a),g=O(a,"P",{});var xe=y(g);_=k(xe,"The recovery metrics on these charts are based on a sample of mobile phone data."),xe.forEach(c),A=U(a),E=O(a,"P",{});var Ie=y(E);v=k(Ie,"They are computed by counting the number of unique mobile phones in a city's downtown area in the specified time period, and then dividing it by the number of unique visitors during the equivalent time period in 2019. For example, the March 2023 - May 2023 time period is compared to the March 2019 - May 2019 time period."),Ie.forEach(c),p=U(a),R=O(a,"P",{});var Ae=y(R);F=k(Ae,"A recovery metric greater than 100% means that for the selected inputs, the mobile device activity increased relative to the comparison period. A value less than 100% means the opposite, that the city's downtown has not recovered to pre-COVID activity levels."),Ae.forEach(c),X=U(a),V=O(a,"P",{});var re=y(V);b=k(re,"For more information, read our "),H=O(re,"A",{href:!0});var Pe=y(H);n=k(Pe,"Methodology"),Pe.forEach(c),m=k(re," page. Or click "),P=O(re,"A",{href:!0});var Ve=y(P);G=k(Ve,"here"),Ve.forEach(c),_e=k(re," to download the data shown on this chart."),re.forEach(c),a.forEach(c),ce=U(I),z=O(I,"DIV",{id:!0,class:!0});var fe=y(z);N=O(fe,"DIV",{id:!0,class:!0});var se=y(N);J=O(se,"DIV",{id:!0,class:!0});var qe=y(J);ye(K.$$.fragment,qe),qe.forEach(c),de=U(se),L=O(se,"DIV",{id:!0,class:!0});var Oe=y(L);ye(Y.$$.fragment,Oe),Oe.forEach(c),ve=U(se),Z=O(se,"P",{id:!0,class:!0});var Re=y(Z);pe=k(Re,"*Data for Europe is only available from 12/2021 to 02/2023"),Re.forEach(c),se.forEach(c),me=U(fe),M=B(fe,"svg",{height:!0,width:!0,id:!0,class:!0});var ue=y(M);for(let j=0;j<D.length;j+=1)D[j].l(ue);ne=oe();for(let j=0;j<S.length;j+=1)S[j].l(ue);he=oe();for(let j=0;j<x.length;j+=1)x[j].l(ue);ue.forEach(c),fe.forEach(c),I.forEach(c),this.h()},h(){l(H,"href",rt+"/methodology"),l(P,"href","/ranking_data.csv"),l(s,"class","text"),l(J,"id","options-season"),l(J,"class","svelte-1r8269s"),l(L,"id","options-region"),l(L,"class","svelte-1r8269s"),l(Z,"id","note"),l(Z,"class","svelte-1r8269s"),l(N,"id","options"),l(N,"class","svelte-1r8269s"),l(M,"height",e[3]),l(M,"width",e[1]),l(M,"id","chart"),l(M,"class","svelte-1r8269s"),l(z,"id","chart-wrapper"),l(z,"class","svelte-1r8269s"),Ue(()=>e[13].call(z)),l(r,"class","svelte-1r8269s")},m(o,I){be(t,o,I),C(o,h,I),C(o,r,I),f(r,s),f(s,i),f(i,u),f(s,d),f(s,g),f(g,_),f(s,A),f(s,E),f(E,v),f(s,p),f(s,R),f(R,F),f(s,X),f(s,V),f(V,b),f(V,H),f(H,n),f(V,m),f(V,P),f(P,G),f(V,_e),f(r,ce),f(r,z),f(z,N),f(N,J),be(K,J,null),f(N,de),f(N,L),be(Y,L,null),f(N,ve),f(N,Z),f(Z,pe),f(z,me),f(z,M);for(let a=0;a<D.length;a+=1)D[a]&&D[a].m(M,null);f(M,ne);for(let a=0;a<S.length;a+=1)S[a]&&S[a].m(M,null);f(M,he);for(let a=0;a<x.length;a+=1)x[a]&&x[a].m(M,null);Se=Xe(z,e[13].bind(z)),ee=!0},p(o,[I]){if(I&28){te=o[2];let a;for(a=0;a<te.length;a+=1){const $=ze(o,te,a);D[a]?D[a].p($,I):(D[a]=Te($),D[a].c(),D[a].m(M,ne))}for(;a<D.length;a+=1)D[a].d(1);D.length=te.length}if(I&39){le=o[0];let a;for(a=0;a<le.length;a+=1){const $=Fe(o,le,a);S[a]?S[a].p($,I):(S[a]=Ne($),S[a].c(),S[a].m(M,he))}for(;a<S.length;a+=1)S[a].d(1);S.length=le.length}if(I&28){ae=o[2];let a;for(a=0;a<ae.length;a+=1){const $=Ce(o,ae,a);x[a]?x[a].p($,I):(x[a]=je($),x[a].c(),x[a].m(M,null))}for(;a<x.length;a+=1)x[a].d(1);x.length=ae.length}(!ee||I&8)&&l(M,"height",o[3]),(!ee||I&2)&&l(M,"width",o[1])},i(o){ee||(we(t.$$.fragment,o),we(K.$$.fragment,o),we(Y.$$.fragment,o),ee=!0)},o(o){ke(t.$$.fragment,o),ke(K.$$.fragment,o),ke(Y.$$.fragment,o),ee=!1},d(o){Ee(t,o),o&&c(h),o&&c(r),Ee(K),Ee(Y),Me(D,o),Me(S,o),Me(x,o),Se()}}}const rt="/downtown-recovery";function st(e,t,h){let r,s,i,u;De(e,Ze,n=>h(8,s=n)),De(e,et,n=>h(9,i=n)),De(e,tt,n=>h(14,u=n));let d=[],g=[];const _=u;async function A(){try{const m=await(await fetch("../ranking_data.csv")).text();h(6,d=Ye(m))}catch(n){console.error("Error loading CSV data:",n)}}Ge(()=>{A()});let E,v=100,p=1;function R(n,m){let P=[];for(let G=0;G<=Math.ceil(n/m);G++)P.push(G*m);return P}let F=[];const X=(n,m)=>m.name===n.region,V=(n,m)=>m.name===n.region,b=(n,m)=>m.name===n.region;function H(){E=this.offsetWidth,h(1,E)}return e.$$.update=()=>{e.$$.dirty&832&&h(0,g=d.filter(n=>n.metric==="downtown").filter(n=>n.Season===`Season_${i}`).filter(n=>s.includes(n.region)).sort((n,m)=>m.seasonal_average-n.seasonal_average)),e.$$.dirty&1&&h(3,v=24*g.length+50),e.$$.dirty&1&&h(7,p=g.length!==0?g[0].seasonal_average:1),e.$$.dirty&128&&h(7,p=p<1?1:p),e.$$.dirty&128&&(p<2?h(2,F=R(p,.2)):h(2,F=R(p,.5))),e.$$.dirty&6&&h(4,r=(E-40)/(F.length-1))},[g,E,F,v,r,_,d,p,s,i,X,V,b,H]}class ut extends We{constructor(t){super(),Be(this,t,st,at,Qe,{})}}export{ut as component,ft as universal};
