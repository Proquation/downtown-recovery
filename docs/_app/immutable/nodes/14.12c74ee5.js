import{S as rt,i as ot,s as nt,y as Je,a as H,k as j,q as w,N,e as ie,z as Ne,c as J,l as P,m,r as b,h as c,O as B,n as a,P as lt,A as Be,b as C,C as i,Q as it,g as Ue,d as Qe,B as Xe,M as Ie,E as Ge,o as st,u as se,p as R}from"../chunks/index.a4677e45.js";import{H as ht}from"../chunks/global.2cdf0447.js";import{S as ut}from"../chunks/SelectRegions.52f2c280.js";import{c as ft,a as dt,r as ct}from"../chunks/csv.a2f71406.js";const _t=!0,bt=Object.freeze(Object.defineProperty({__proto__:null,prerender:_t},Symbol.toStringTag,{value:"Module"}));function Ke(e,t,n){const s=e.slice();return s[16]=t[n],s[18]=n,s}function Le(e,t,n){const s=e.slice();return s[19]=t[n],s[18]=n,s}function Ye(e,t,n){const s=e.slice();return s[16]=t[n],s[18]=n,s}function Ze(e){let t,n,s,r,u,h,_,g=(100*e[16]).toFixed(0)+"",p,M,O;return{c(){t=N("line"),r=N("line"),_=N("text"),p=w(g),M=w("%"),this.h()},l(f){t=B(f,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0}),m(t).forEach(c),r=B(f,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0}),m(r).forEach(c),_=B(f,"text",{class:!0,x:!0,y:!0,"text-anchor":!0});var v=m(_);p=b(v,g),M=b(v,"%"),v.forEach(c),this.h()},h(){a(t,"class","grid svelte-13rj6d7"),a(t,"x1",n=29+e[18]*e[4]),a(t,"y1","34"),a(t,"x2",s=29+e[18]*e[4]),a(t,"y2",e[3]),a(r,"class","grid-white svelte-13rj6d7"),a(r,"x1",u=29+e[18]*e[4]),a(r,"y1","34"),a(r,"x2",h=29+e[18]*e[4]),a(r,"y2","38"),a(_,"class","axis-label svelte-13rj6d7"),a(_,"x",O=35+e[18]*e[4]),a(_,"y","30"),a(_,"text-anchor","end")},m(f,v){C(f,t,v),C(f,r,v),C(f,_,v),i(_,p),i(_,M)},p(f,v){v&16&&n!==(n=29+f[18]*f[4])&&a(t,"x1",n),v&16&&s!==(s=29+f[18]*f[4])&&a(t,"x2",s),v&8&&a(t,"y2",f[3]),v&16&&u!==(u=29+f[18]*f[4])&&a(r,"x1",u),v&16&&h!==(h=29+f[18]*f[4])&&a(r,"x2",h),v&4&&g!==(g=(100*f[16]).toFixed(0)+"")&&se(p,g),v&16&&O!==(O=35+f[18]*f[4])&&a(_,"x",O)},d(f){f&&c(t),f&&c(r),f&&c(_)}}}function $e(e){let t,n=e[19].display_title+"",s,r,u=Math.round(100*e[19].seasonal_average)+"",h,_;return{c(){t=N("text"),s=w(n),r=w(" - "),h=w(u),_=w("%"),this.h()},l(g){t=B(g,"text",{class:!0,x:!0,y:!0,style:!0});var p=m(t);s=b(p,n),r=b(p," - "),h=b(p,u),_=b(p,"%"),p.forEach(c),this.h()},h(){a(t,"class","bar-label svelte-13rj6d7"),a(t,"x","32"),a(t,"y",56+e[18]*24),R(t,"fill","#000"),R(t,"fill-opacity","0"),R(t,"stroke","white"),R(t,"stroke-width","3px"),R(t,"stroke-opacity","0.62")},m(g,p){C(g,t,p),i(t,s),i(t,r),i(t,h),i(t,_)},p(g,p){p&1&&n!==(n=g[19].display_title+"")&&se(s,n),p&1&&u!==(u=Math.round(100*g[19].seasonal_average)+"")&&se(h,u)},d(g){g&&c(t)}}}function et(e){let t=e[5].find(G).text==="#000",n,s,r,u,h,_=e[18]+1+"",g,p,M=e[19].display_title+"",O,f,v=Math.round(100*e[19].seasonal_average)+"",x,W;function G(...d){return e[9](e[19],...d)}let E=t&&$e(e);function U(...d){return e[10](e[19],...d)}function k(...d){return e[11](e[19],...d)}return{c(){E&&E.c(),n=N("line"),r=N("line"),h=N("text"),g=w(_),p=N("text"),O=w(M),f=w(" - "),x=w(v),W=w("%"),this.h()},l(d){E&&E.l(d),n=B(d,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,style:!0}),m(n).forEach(c),r=B(d,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,style:!0}),m(r).forEach(c),h=B(d,"text",{class:!0,x:!0,y:!0,"text-anchor":!0});var y=m(h);g=b(y,_),y.forEach(c),p=B(d,"text",{class:!0,x:!0,y:!0,style:!0});var q=m(p);O=b(q,M),f=b(q," - "),x=b(q,v),W=b(q,"%"),q.forEach(c),this.h()},h(){a(n,"class","bar"),a(n,"x1",29),a(n,"y1",52+e[18]*24),a(n,"x2",s=29+(e[1]-50)*e[19].seasonal_average/Math.max(...e[2])),a(n,"y2",52+e[18]*24),R(n,"stroke","white"),R(n,"stroke-width","20 "),a(r,"class","bar"),a(r,"x1",30),a(r,"y1",52+e[18]*24),a(r,"x2",u=29+(e[1]-50)*e[19].seasonal_average/Math.max(...e[2])-1),a(r,"y2",52+e[18]*24),R(r,"stroke",e[5].find(U).colour),R(r,"stroke-width","18"),a(h,"class","axis-label svelte-13rj6d7"),a(h,"x","25"),a(h,"y",57+e[18]*24),a(h,"text-anchor","end"),a(p,"class","bar-label svelte-13rj6d7"),a(p,"x","32"),a(p,"y",56+e[18]*24),R(p,"fill",e[5].find(k).text)},m(d,y){E&&E.m(d,y),C(d,n,y),C(d,r,y),C(d,h,y),i(h,g),C(d,p,y),i(p,O),i(p,f),i(p,x),i(p,W)},p(d,y){e=d,y&1&&(t=e[5].find(G).text==="#000"),t?E?E.p(e,y):(E=$e(e),E.c(),E.m(n.parentNode,n)):E&&(E.d(1),E=null),y&7&&s!==(s=29+(e[1]-50)*e[19].seasonal_average/Math.max(...e[2]))&&a(n,"x2",s),y&7&&u!==(u=29+(e[1]-50)*e[19].seasonal_average/Math.max(...e[2])-1)&&a(r,"x2",u),y&1&&R(r,"stroke",e[5].find(U).colour),y&1&&M!==(M=e[19].display_title+"")&&se(O,M),y&1&&v!==(v=Math.round(100*e[19].seasonal_average)+"")&&se(x,v),y&1&&R(p,"fill",e[5].find(k).text)},d(d){E&&E.d(d),d&&c(n),d&&c(r),d&&c(h),d&&c(p)}}}function tt(e){let t,n,s;return{c(){t=N("line"),this.h()},l(r){t=B(r,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,"stroke-opacity":!0,"stroke-dasharray":!0}),m(t).forEach(c),this.h()},h(){a(t,"class","grid-white svelte-13rj6d7"),a(t,"x1",n=29+e[18]*e[4]),a(t,"y1","34"),a(t,"x2",s=29+e[18]*e[4]),a(t,"y2",e[3]),a(t,"stroke-opacity","0.75"),a(t,"stroke-dasharray","2 2")},m(r,u){C(r,t,u)},p(r,u){u&16&&n!==(n=29+r[18]*r[4])&&a(t,"x1",n),u&16&&s!==(s=29+r[18]*r[4])&&a(t,"x2",s),u&8&&a(t,"y2",r[3])},d(r){r&&c(t)}}}function at(e){let t,n,s,r,u=e[16]===1&&tt(e);return{c(){t=N("line"),u&&u.c(),r=ie(),this.h()},l(h){t=B(h,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,"stroke-opacity":!0}),m(t).forEach(c),u&&u.l(h),r=ie(),this.h()},h(){a(t,"class","grid svelte-13rj6d7"),a(t,"x1",n=29+e[18]*e[4]),a(t,"y1","34"),a(t,"x2",s=29+e[18]*e[4]),a(t,"y2",e[3]),a(t,"stroke-opacity","0.21")},m(h,_){C(h,t,_),u&&u.m(h,_),C(h,r,_)},p(h,_){_&16&&n!==(n=29+h[18]*h[4])&&a(t,"x1",n),_&16&&s!==(s=29+h[18]*h[4])&&a(t,"x2",s),_&8&&a(t,"y2",h[3]),h[16]===1?u?u.p(h,_):(u=tt(h),u.c(),u.m(r.parentNode,r)):u&&(u.d(1),u=null)},d(h){h&&c(t),u&&u.d(h),h&&c(r)}}}function pt(e){let t,n,s,r,u,h,_,g,p,M,O,f,v,x,W,G,E,U,k,d,y,q,pe,Q,me,Z,ve,ge,$,ye,we,be,K,ke,ee,Ee,Me,Se,V,X,L,Y,je,te,Pe,Ae,S,he,ue,ze,ae;t=new ht({}),Y=new ut({props:{europe:"no"}});let re=e[2],A=[];for(let l=0;l<re.length;l+=1)A[l]=Ze(Ye(e,re,l));let oe=e[0],I=[];for(let l=0;l<oe.length;l+=1)I[l]=et(Le(e,oe,l));let ne=e[2],z=[];for(let l=0;l<ne.length;l+=1)z[l]=at(Ke(e,ne,l));return{c(){Je(t.$$.fragment),n=H(),s=j("main"),r=j("div"),u=j("h1"),h=w("Downtown Recovery Rankings"),_=H(),g=j("p"),p=j("i"),M=w("Updated October 16, 2023"),O=H(),f=j("p"),v=w("The recovery metrics on these charts are based on a sample of mobile phone data."),x=H(),W=j("p"),G=w("The recovery metrics on the charts and maps are computed by counting the number of unique visitors in a city's downtown area in the specified time period (standardized by region), and then dividing it by the standardized number of unique visitors during the equivalent time period in 2019. Specifically, the rankings below compare the period from the beginning of March to mid-June in 2023 relative to the same period in 2019."),E=H(),U=j("p"),k=w("A recovery metric greater than 100% means that for the selected inputs, the mobile device activity increased relative to the 2019 comparison period. A value less than 100% means the opposite, that the city's downtown has not recovered to pre-COVID activity levels."),d=H(),y=j("p"),q=w("Our rankings look a little different from our last update for four reasons: (1) we shifted from combining data from two providers (Safegraph and Spectus) to using just one (Spectus); (2) we changed how we define downtown to reflect the central location with the highest concentration of private sector employment (see methodology for more details); (3) we are standardizing now by MSA instead of state/province (see methodology); and (4) we are now showing data through mid-June instead of end of May."),pe=H(),Q=j("p"),me=w("For more information, read our "),Z=j("a"),ve=w("Methodology"),ge=w(" page. Or click "),$=j("a"),ye=w("here"),we=w(" to download the data shown on this chart."),be=H(),K=j("p"),ke=w("Interested in seeing updated rankings? We are too! But we are seeking financial sponsors to enable us to continue the work. Please contact "),ee=j("a"),Ee=w("karen.chapple@utoronto.ca"),Me=w(" if you would like to become our inaugural sponsor!"),Se=H(),V=j("div"),X=j("div"),L=j("div"),Je(Y.$$.fragment),je=H(),te=j("p"),Pe=w("*We are currently working on updating data for Canadian cities"),Ae=H(),S=N("svg");for(let l=0;l<A.length;l+=1)A[l].c();he=ie();for(let l=0;l<I.length;l+=1)I[l].c();ue=ie();for(let l=0;l<z.length;l+=1)z[l].c();this.h()},l(l){Ne(t.$$.fragment,l),n=J(l),s=P(l,"MAIN",{class:!0});var D=m(s);r=P(D,"DIV",{class:!0});var o=m(r);u=P(o,"H1",{});var T=m(u);h=b(T,"Downtown Recovery Rankings"),T.forEach(c),_=J(o),g=P(o,"P",{});var De=m(g);p=P(De,"I",{});var Oe=m(p);M=b(Oe,"Updated October 16, 2023"),Oe.forEach(c),De.forEach(c),O=J(o),f=P(o,"P",{});var xe=m(f);v=b(xe,"The recovery metrics on these charts are based on a sample of mobile phone data."),xe.forEach(c),x=J(o),W=P(o,"P",{});var qe=m(W);G=b(qe,"The recovery metrics on the charts and maps are computed by counting the number of unique visitors in a city's downtown area in the specified time period (standardized by region), and then dividing it by the standardized number of unique visitors during the equivalent time period in 2019. Specifically, the rankings below compare the period from the beginning of March to mid-June in 2023 relative to the same period in 2019."),qe.forEach(c),E=J(o),U=P(o,"P",{});var Ce=m(U);k=b(Ce,"A recovery metric greater than 100% means that for the selected inputs, the mobile device activity increased relative to the 2019 comparison period. A value less than 100% means the opposite, that the city's downtown has not recovered to pre-COVID activity levels."),Ce.forEach(c),d=J(o),y=P(o,"P",{});var Ve=m(y);q=b(Ve,"Our rankings look a little different from our last update for four reasons: (1) we shifted from combining data from two providers (Safegraph and Spectus) to using just one (Spectus); (2) we changed how we define downtown to reflect the central location with the highest concentration of private sector employment (see methodology for more details); (3) we are standardizing now by MSA instead of state/province (see methodology); and (4) we are now showing data through mid-June instead of end of May."),Ve.forEach(c),pe=J(o),Q=P(o,"P",{});var le=m(Q);me=b(le,"For more information, read our "),Z=P(le,"A",{href:!0});var Re=m(Z);ve=b(Re,"Methodology"),Re.forEach(c),ge=b(le," page. Or click "),$=P(le,"A",{href:!0});var We=m($);ye=b(We,"here"),We.forEach(c),we=b(le," to download the data shown on this chart."),le.forEach(c),be=J(o),K=P(o,"P",{});var fe=m(K);ke=b(fe,"Interested in seeing updated rankings? We are too! But we are seeking financial sponsors to enable us to continue the work. Please contact "),ee=P(fe,"A",{href:!0});var Te=m(ee);Ee=b(Te,"karen.chapple@utoronto.ca"),Te.forEach(c),Me=b(fe," if you would like to become our inaugural sponsor!"),fe.forEach(c),o.forEach(c),Se=J(D),V=P(D,"DIV",{id:!0,class:!0});var de=m(V);X=P(de,"DIV",{id:!0,class:!0});var ce=m(X);L=P(ce,"DIV",{id:!0,class:!0});var Fe=m(L);Ne(Y.$$.fragment,Fe),Fe.forEach(c),je=J(ce),te=P(ce,"P",{id:!0});var He=m(te);Pe=b(He,"*We are currently working on updating data for Canadian cities"),He.forEach(c),ce.forEach(c),Ae=J(de),S=B(de,"svg",{height:!0,width:!0,id:!0,class:!0});var _e=m(S);for(let F=0;F<A.length;F+=1)A[F].l(_e);he=ie();for(let F=0;F<I.length;F+=1)I[F].l(_e);ue=ie();for(let F=0;F<z.length;F+=1)z[F].l(_e);_e.forEach(c),de.forEach(c),D.forEach(c),this.h()},h(){a(Z,"href","/methodology"),a($,"href","/recovery_rankings.csv"),a(ee,"href","karen.chapple@utoronto.ca"),a(r,"class","text"),a(L,"id","options-region"),a(L,"class","svelte-13rj6d7"),a(te,"id","note"),a(X,"id","options"),a(X,"class","svelte-13rj6d7"),a(S,"height",e[3]),a(S,"width",e[1]),a(S,"id","chart"),a(S,"class","svelte-13rj6d7"),a(V,"id","chart-wrapper"),a(V,"class","svelte-13rj6d7"),lt(()=>e[12].call(V)),a(s,"class","svelte-13rj6d7")},m(l,D){Be(t,l,D),C(l,n,D),C(l,s,D),i(s,r),i(r,u),i(u,h),i(r,_),i(r,g),i(g,p),i(p,M),i(r,O),i(r,f),i(f,v),i(r,x),i(r,W),i(W,G),i(r,E),i(r,U),i(U,k),i(r,d),i(r,y),i(y,q),i(r,pe),i(r,Q),i(Q,me),i(Q,Z),i(Z,ve),i(Q,ge),i(Q,$),i($,ye),i(Q,we),i(r,be),i(r,K),i(K,ke),i(K,ee),i(ee,Ee),i(K,Me),i(s,Se),i(s,V),i(V,X),i(X,L),Be(Y,L,null),i(X,je),i(X,te),i(te,Pe),i(V,Ae),i(V,S);for(let o=0;o<A.length;o+=1)A[o]&&A[o].m(S,null);i(S,he);for(let o=0;o<I.length;o+=1)I[o]&&I[o].m(S,null);i(S,ue);for(let o=0;o<z.length;o+=1)z[o]&&z[o].m(S,null);ze=it(V,e[12].bind(V)),ae=!0},p(l,[D]){if(D&28){re=l[2];let o;for(o=0;o<re.length;o+=1){const T=Ye(l,re,o);A[o]?A[o].p(T,D):(A[o]=Ze(T),A[o].c(),A[o].m(S,he))}for(;o<A.length;o+=1)A[o].d(1);A.length=re.length}if(D&39){oe=l[0];let o;for(o=0;o<oe.length;o+=1){const T=Le(l,oe,o);I[o]?I[o].p(T,D):(I[o]=et(T),I[o].c(),I[o].m(S,ue))}for(;o<I.length;o+=1)I[o].d(1);I.length=oe.length}if(D&28){ne=l[2];let o;for(o=0;o<ne.length;o+=1){const T=Ke(l,ne,o);z[o]?z[o].p(T,D):(z[o]=at(T),z[o].c(),z[o].m(S,null))}for(;o<z.length;o+=1)z[o].d(1);z.length=ne.length}(!ae||D&8)&&a(S,"height",l[3]),(!ae||D&2)&&a(S,"width",l[1])},i(l){ae||(Ue(t.$$.fragment,l),Ue(Y.$$.fragment,l),ae=!0)},o(l){Qe(t.$$.fragment,l),Qe(Y.$$.fragment,l),ae=!1},d(l){Xe(t,l),l&&c(n),l&&c(s),Xe(Y),Ie(A,l),Ie(I,l),Ie(z,l),ze()}}}function mt(e,t,n){let s,r,u;Ge(e,dt,k=>n(8,r=k)),Ge(e,ct,k=>n(13,u=k));let h=[],_=[];const g=u;async function p(){try{const d=await(await fetch("../recovery_rankings.csv")).text();n(6,h=ft(d))}catch(k){console.error("Error loading CSV data:",k)}}st(()=>{p()});let M,O=100,f=1;function v(k,d){let y=[];for(let q=0;q<=Math.ceil(k/d);q++)y.push(q*d);return y}let x=[];const W=(k,d)=>d.name===k.region,G=(k,d)=>d.name===k.region,E=(k,d)=>d.name===k.region;function U(){M=this.offsetWidth,n(1,M)}return e.$$.update=()=>{e.$$.dirty&320&&n(0,_=h.filter(k=>r.includes(k.region)).sort((k,d)=>d.seasonal_average-k.seasonal_average)),e.$$.dirty&1&&n(3,O=24*_.length+50),e.$$.dirty&1&&n(7,f=_.length!==0?_[0].seasonal_average:1),e.$$.dirty&128&&n(7,f=f<1?1:f),e.$$.dirty&128&&(f<2?n(2,x=v(f,.2)):n(2,x=v(f,.5))),e.$$.dirty&6&&n(4,s=(M-50)/(x.length-1))},[_,M,x,O,s,g,h,f,r,W,G,E,U]}class kt extends rt{constructor(t){super(),ot(this,t,mt,pt,nt,{})}}export{kt as component,bt as universal};
